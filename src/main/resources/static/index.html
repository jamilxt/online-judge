<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Judge - Practice Coding Problems</title>
    <meta name="description" content="Practice coding problems and improve your programming skills with our online judge platform.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo">
                <div class="logo-icon">âš¡</div>
                <span class="logo-text">CodeJudge</span>
            </a>
            <nav class="nav-links">
                <a href="/" class="nav-link active">Problems</a>
                <a href="#" class="nav-link">Submissions</a>
                <a href="#" class="nav-link">Leaderboard</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="page-title">Problem Set</h1>
            <p class="page-subtitle">Select a problem to start coding</p>
        </div>

        <!-- Stats -->
        <div class="stats-bar">
            <div class="stat-card">
                <div class="stat-icon problems">ðŸ“š</div>
                <div class="stat-content">
                    <h3 id="total-problems">-</h3>
                    <p>Total Problems</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon solved">âœ…</div>
                <div class="stat-content">
                    <h3 id="easy-count">-</h3>
                    <p>Easy Problems</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon submissions">ðŸš€</div>
                <div class="stat-content">
                    <h3 id="medium-count">-</h3>
                    <p>Medium Problems</p>
                </div>
            </div>
        </div>

        <!-- Problem List -->
        <div class="problem-list" id="problem-list">
            <!-- Loading skeletons -->
            <div class="problem-card skeleton" style="height: 80px;"></div>
            <div class="problem-card skeleton" style="height: 80px;"></div>
            <div class="problem-card skeleton" style="height: 80px;"></div>
        </div>
    </main>

    <script>
        const API_BASE = '';

        async function loadProblems() {
            try {
                const response = await fetch(`${API_BASE}/api/problems`);
                const problems = await response.json();
                
                renderProblems(problems);
                updateStats(problems);
            } catch (error) {
                console.error('Failed to load problems:', error);
                document.getElementById('problem-list').innerHTML = `
                    <div class="empty-state">
                        <h3>Failed to load problems</h3>
                        <p>Please check if the server is running.</p>
                    </div>
                `;
            }
        }

        function renderProblems(problems) {
            const container = document.getElementById('problem-list');
            
            if (problems.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>No problems available</h3>
                        <p>Check back later for new challenges!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = problems.map(problem => `
                <a href="/problem.html?id=${problem.id}" class="problem-card">
                    <div class="problem-id">#${problem.id}</div>
                    <div class="problem-info">
                        <h3>${escapeHtml(problem.title)}</h3>
                        <p>Time: ${problem.timeLimit}ms â€¢ Memory: ${Math.round(problem.memoryLimit / 1024)}MB</p>
                    </div>
                    <span class="difficulty-badge ${problem.difficulty.toLowerCase()}">${problem.difficulty}</span>
                    <div class="problem-meta">
                        <span>ðŸŽ¯ Solve</span>
                    </div>
                </a>
            `).join('');
        }

        function updateStats(problems) {
            document.getElementById('total-problems').textContent = problems.length;
            document.getElementById('easy-count').textContent = 
                problems.filter(p => p.difficulty === 'EASY').length;
            document.getElementById('medium-count').textContent = 
                problems.filter(p => p.difficulty === 'MEDIUM').length;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Load problems on page load
        document.addEventListener('DOMContentLoaded', loadProblems);
    </script>
</body>
</html>
